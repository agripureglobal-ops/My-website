<section id="contact" style="padding: 60px 8%;">
    <div class="form-card" style="max-width: 600px; margin: 0 auto; background: #fff; padding: 40px; border-radius: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 1px solid #eee;">
        <h3 style="margin-top:0; color:var(--primary);">Request a Quote</h3>
        <form id="my-form" action="https://formspree.io/f/mykdelle" method="POST">
            <div class="form-group" style="margin-bottom: 20px;">
                <label style="display:block; margin-bottom:8px; font-weight:700;">Company / Full Name</label>
                <input type="text" name="name" required style="width:100%; padding:12px; border:1px solid #ddd; border-radius:6px;">
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label style="display:block; margin-bottom:8px; font-weight:700;">Your Email Address</label>
                <input type="email" name="_replyto" required style="width:100%; padding:12px; border:1px solid #ddd; border-radius:6px;">
            </div>

            <div class="form-group" style="margin-bottom: 20px;">
                <label style="display:block; margin-bottom:8px; font-weight:700;">Product Interest</label>
                <select name="product" id="product-dropdown" style="width:100%; padding:12px; border:1px solid #ddd; border-radius:6px;">
                    <option value="Jaggery Blocks">Jaggery Blocks</option>
                    <option value="Jaggery Liquid">Jaggery Liquid</option>
                    <option value="Jaggery Cubes">Jaggery Cubes</option>
                    <option value="Jaggery Powder">Jaggery Powder</option>
                    <option value="Raw Forest Honey">Raw Forest Honey</option>
                    <option value="Export Grapes">Export Grapes</option>
                    <option value="Red Onions">Red Onions</option>
                    <option value="Onion Powder">Onion Powder</option>
                    <option value="Pomegranates">Pomegranates</option>
                    <option value="Premium Makhana">Premium Makhana</option>
                </select>
            </div>

            <div class="form-group" style="margin-bottom: 25px;">
                <label style="display:block; margin-bottom:8px; font-weight:700;">Message</label>
                <textarea name="message" rows="4" required style="width:100%; padding:12px; border:1px solid #ddd; border-radius:6px;"></textarea>
            </div>

            <button type="submit" id="my-form-status" style="width:100%; padding:15px; background:#1b4332; color:white; border:none; border-radius:6px; font-weight:800; cursor:pointer; text-transform:uppercase; transition:0.3s;">Send Inquiry</button>
        </form>
    </div>
</section>

<script>
  // 1. READ URL AND AUTO-SELECT PRODUCT
  window.addEventListener('DOMContentLoaded', () => {
    const urlParams = new URLSearchParams(window.location.search);
    const productToSelect = urlParams.get('product');
    if (productToSelect) {
        const selectElement = document.getElementById('product-dropdown');
        if (selectElement) { selectElement.value = productToSelect; }
    }
  });

  // 2. AJAX SUBMISSION (STAY ON PAGE)
  var form = document.getElementById("my-form");
  async function handleSubmit(event) {
    event.preventDefault();
    var status = document.getElementById("my-form-status");
    var data = new FormData(event.target);
    status.innerHTML = "Sending...";
    status.disabled = true;

    fetch(event.target.action, {
      method: form.method,
      body: data,
      headers: { 'Accept': 'application/json' }
    }).then(response => {
      if (response.ok) {
        status.innerHTML = "Thank you, we will reach out soon.";
        status.style.backgroundColor = "#28a745"; 
        status.style.width = "auto";
        status.style.padding = "10px 20px";
        form.reset(); 
      } else {
        status.innerHTML = "Oops! Error sending.";
        status.disabled = false;
      }
    }).catch(error => {
      status.innerHTML = "Connection Error.";
      status.disabled = false;
    });
  }
  form.addEventListener("submit", handleSubmit);
</script>
</body>
</html>
